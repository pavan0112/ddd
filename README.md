# Hallucination Detection
Detecting hallucinations in responses generated by Large Language Models (LLMs), particularly in scenarios where a query is accompanied by retrieved contexts
## Overview
This includes 2 steps
### Step-1: Generating atomic sentences
In this step, we will generate atomic sentences using InstructGPT
### Step-2: Calculating final score
In this step, we use Natural Language Inference (NLI) models, which assign both entailment and contradiction scores for each atomic sentence relative to the contexts. 
Each atomic sentence receives entailment and contradiction scores with every context, and we consider the maximum score from these comparisons to decide whether the fact is supported or contradicted.
#### Score Calculation Procedure:
1.	Hallucination Detection: For each atomic sentence in the response, if the contradiction score is higher than the entailment score, the sentence is classified as hallucinated.
2.	Hallucinated Responses: If the response contains hallucinated sentences, the overall score is calculated based on the entailment scores of the hallucinated sentences. For a more comprehensive evaluation, we consider the minimum, maximum, and mean of these entailment scores.
3.	Non-Hallucinated Responses: If no hallucinated sentences are detected, the overall score is determined using the entailment scores of all atomic sentences in the response. Similar to hallucinated responses, the minimum, maximum, and mean of the entailment scores are taken into account.
4.	Score Representation: These scores represent the factual correctness and reliability of the response, providing insight into its overall accuracy based on the support from retrieved contexts.

## Instructions to run the code:
### Step-1 : Generating atomic sentences
1. Ensure you have access to InstructGPT via Hugging Face.
2. Generate an access token and use it to log in within the code.
3. Modify the following:
    + The path to input_data
    + The column name for the responses
    + The desired output filename
### Step-2 : Calculating scores
1. Update the file path for the atomic sentences.
2. Specify the desired output filename. 
